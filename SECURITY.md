# 安全配置指南

## 1. 环境变量安全配置

为确保系统安全，请在生产环境中修改以下关键配置：

### 必须修改的配置项：

1. **SECRET_KEY**: 
   - 位置: `.env` 文件第52行
   - 说明: Flask会话签名密钥，必须修改为一个强随机字符串
   - 生成方法: `python -c 'import secrets; print(secrets.token_hex(24))'`

2. **数据库默认用户密码**:
   - 位置: `web_server.py` 文件第110行
   - 说明: 系统初始化时创建的默认管理员账户密码
   - 建议: 部署后立即登录并修改默认密码

3. **API密钥配置**:
   - 位置: `.env` 文件中的各种API密钥
   - 说明: 包括OPENAI_API_KEY, SERP_API_KEY, TAVILY_API_KEY等
   - 建议: 使用实际的API密钥替换默认值

### 可选但推荐的安全配置：

1. **启用CSRF保护**:
   - Flask-WTF已集成，确保所有表单都包含CSRF令牌

2. **API访问控制**:
   - 使用`auth_middleware.py`中的装饰器保护敏感API端点

3. **HMAC签名验证**:
   - 对于重要的Webhook接口，建议启用HMAC签名验证
   - 配置`HMAC_SECRET`环境变量

## 2. 安全最佳实践

### 2.1 密码安全
- 所有密码应至少包含8个字符
- 推荐使用大小写字母、数字和特殊字符的组合
- 定期更换密码

### 2.2 API密钥管理
- 不要在代码中硬编码API密钥
- 定期轮换API密钥
- 限制API密钥的权限范围

### 2.3 访问控制
- 使用角色基础的访问控制(RBAC)
- 对敏感操作进行二次验证
- 记录所有管理员操作日志

### 2.4 数据安全
- 敏感数据在数据库中应加密存储
- 定期备份数据库
- 限制数据库访问权限

## 3. 安全检查清单

在部署到生产环境前，请检查以下项目：

- [ ] 修改SECRET_KEY为强随机字符串
- [ ] 修改默认管理员密码
- [ ] 配置实际的API密钥
- [ ] 启用HTTPS
- [ ] 配置防火墙规则
- [ ] 定期更新依赖包
- [ ] 启用日志审计
- [ ] 配置定期安全扫描

## 4. 应急响应

如果发现安全漏洞，请立即：

1. 更改相关密码和API密钥
2. 检查系统日志寻找异常活动
3. 更新受影响的组件
4. 通知系统管理员